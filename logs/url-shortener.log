2024-08-26 12:00:32.309  INFO --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [de.telran.urlshortener.UrlShortenerApplicationTests]: UrlShortenerApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2024-08-26 12:00:32.490  INFO --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration de.telran.urlshortener.UrlShortenerApplication for test class de.telran.urlshortener.UrlShortenerApplicationTests
2024-08-26 12:00:33.172  INFO --- [kground-preinit] o.h.v.i.u.Version                        : HV000001: Hibernate Validator 8.0.1.Final
2024-08-26 12:00:33.228  INFO --- [           main] d.t.u.UrlShortenerApplicationTests       : Starting UrlShortenerApplicationTests using Java 21.0.2 with PID 171621 (started by volodymyr in /home/volodymyr/url-shortener)
2024-08-26 12:00:33.235  INFO --- [           main] d.t.u.UrlShortenerApplicationTests       : No active profile set, falling back to 1 default profile: "default"
2024-08-26 12:00:33.292 DEBUG --- [           main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@6be25526
2024-08-26 12:00:34.654  INFO --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-08-26 12:00:34.768  INFO --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 103 ms. Found 4 JPA repository interfaces.
2024-08-26 12:00:35.576  INFO --- [           main] o.h.j.i.u.LogHelper                      : HHH000204: Processing PersistenceUnitInfo [name: default]
2024-08-26 12:00:35.659  INFO --- [           main] o.h.Version                              : HHH000412: Hibernate ORM core version 6.3.1.Final
2024-08-26 12:00:35.714  INFO --- [           main] o.h.c.i.RegionFactoryInitiator           : HHH000026: Second-level cache disabled
2024-08-26 12:00:36.081  INFO --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2024-08-26 12:00:36.123  INFO --- [           main] c.z.h.HikariDataSource                   : HikariPool-1 - Starting...
2024-08-26 12:00:36.441  INFO --- [           main] c.z.h.p.HikariPool                       : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:dev user=SA
2024-08-26 12:00:36.444  INFO --- [           main] c.z.h.HikariDataSource                   : HikariPool-1 - Start completed.
2024-08-26 12:00:36.481  WARN --- [           main] o.h.o.deprecation                        : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2024-08-26 12:00:37.823  INFO --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2024-08-26 12:00:37.888 DEBUG --- [           main] o.h.SQL                                  : 
    create table roles (
        id bigint generated by default as identity,
        expiry_date timestamp(6),
        name varchar(255) not null check (name in ('ADMIN','TRIAL','PAID')),
        primary key (id)
    )
2024-08-26 12:00:37.903 DEBUG --- [           main] o.h.SQL                                  : 
    create table short_urls (
        id bigint generated by default as identity,
        click_count bigint,
        creation_date timestamp(6),
        expiry_date timestamp(6),
        full_url varchar(255) not null,
        short_key varchar(255) not null,
        user_id bigint,
        primary key (id)
    )
2024-08-26 12:00:37.906 DEBUG --- [           main] o.h.SQL                                  : 
    create table subscriptions (
        id bigint generated by default as identity,
        end_date timestamp(6),
        start_date timestamp(6),
        subscription_type varchar(255) check (subscription_type in ('ADMIN','TRIAL','PAID')),
        user_id bigint,
        primary key (id)
    )
2024-08-26 12:00:37.908 DEBUG --- [           main] o.h.SQL                                  : 
    create table user_roles (
        user_id bigint not null,
        role_id bigint not null,
        primary key (user_id, role_id)
    )
2024-08-26 12:00:37.912 DEBUG --- [           main] o.h.SQL                                  : 
    create table users (
        id bigint generated by default as identity,
        email varchar(255) not null,
        password varchar(255) not null,
        user_name varchar(255) not null,
        primary key (id)
    )
2024-08-26 12:00:37.915 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists roles 
       drop constraint if exists UK_ofx66keruapi6vyqpv6f2or37
2024-08-26 12:00:37.916 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists roles 
       add constraint UK_ofx66keruapi6vyqpv6f2or37 unique (name)
2024-08-26 12:00:37.918 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists short_urls 
       drop constraint if exists UK_idjisas7f7xg6ax6cc63t349j
2024-08-26 12:00:37.919 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists short_urls 
       add constraint UK_idjisas7f7xg6ax6cc63t349j unique (short_key)
2024-08-26 12:00:37.920 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists subscriptions 
       drop constraint if exists UK_l3ommhd1n0tu0k2va0cbp87qe
2024-08-26 12:00:37.921 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists subscriptions 
       add constraint UK_l3ommhd1n0tu0k2va0cbp87qe unique (user_id)
2024-08-26 12:00:37.922 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists users 
       drop constraint if exists UK_6dotkott2kjsp8vw4d0m25fb7
2024-08-26 12:00:37.923 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists users 
       add constraint UK_6dotkott2kjsp8vw4d0m25fb7 unique (email)
2024-08-26 12:00:37.924 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists users 
       drop constraint if exists UK_k8d0f2n7n88w1a16yhua64onx
2024-08-26 12:00:37.925 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists users 
       add constraint UK_k8d0f2n7n88w1a16yhua64onx unique (user_name)
2024-08-26 12:00:37.927 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists short_urls 
       add constraint FKqgjewmkgpppu86xx8t1oe574y 
       foreign key (user_id) 
       references users
2024-08-26 12:00:37.935 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists subscriptions 
       add constraint FKhro52ohfqfbay9774bev0qinr 
       foreign key (user_id) 
       references users
2024-08-26 12:00:37.938 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2024-08-26 12:00:37.941 DEBUG --- [           main] o.h.SQL                                  : 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2024-08-26 12:00:37.946  INFO --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2024-08-26 12:00:38.946  WARN --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2024-08-26 12:00:39.262 DEBUG --- [           main] s.w.s.m.m.a.RequestMappingHandlerMapping : 15 mappings in 'requestMappingHandlerMapping'
2024-08-26 12:00:39.434 DEBUG --- [           main] o.s.w.s.h.SimpleUrlHandlerMapping        : Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2024-08-26 12:00:39.478  INFO --- [           main] o.s.s.w.DefaultSecurityFilterChain       : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@45398bb0, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@35ffe3ac, org.springframework.security.web.context.SecurityContextHolderFilter@661d49d1, org.springframework.security.web.header.HeaderWriterFilter@51bd10f0, org.springframework.web.filter.CorsFilter@60fc4450, org.springframework.security.web.authentication.logout.LogoutFilter@1b472cad, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@27f43664, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@234adbe2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2e674698, org.springframework.security.web.access.ExceptionTranslationFilter@2c40e456, org.springframework.security.web.access.intercept.AuthorizationFilter@feb57b4]
2024-08-26 12:00:39.773 DEBUG --- [           main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2024-08-26 12:00:39.827 DEBUG --- [           main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2024-08-26 12:00:40.102  INFO --- [           main] o.s.b.a.h.H2ConsoleAutoConfiguration     : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:dev'
2024-08-26 12:00:40.222  INFO --- [           main] d.t.u.UrlShortenerApplicationTests       : Started UrlShortenerApplicationTests in 7.454 seconds (process running for 10.133)
2024-08-26 12:00:40.477 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.568 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        roles
        (expiry_date, name, id) 
    values
        (?, ?, default)
2024-08-26 12:00:40.598 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.611 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.613 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        roles
        (expiry_date, name, id) 
    values
        (?, ?, default)
2024-08-26 12:00:40.619 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.621 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        roles
        (expiry_date, name, id) 
    values
        (?, ?, default)
2024-08-26 12:00:40.625 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.629 DEBUG --- [           main] o.h.SQL                                  : 
    select
        r1_0.id,
        r1_0.expiry_date,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.name=?
2024-08-26 12:00:40.637 DEBUG --- [           main] o.h.SQL                                  : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2024-08-26 12:00:40.788 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        users
        (email, password, user_name, id) 
    values
        (?, ?, ?, default)
2024-08-26 12:00:40.805 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2024-08-26 12:00:40.815 DEBUG --- [           main] o.h.SQL                                  : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2024-08-26 12:00:40.932 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        users
        (email, password, user_name, id) 
    values
        (?, ?, ?, default)
2024-08-26 12:00:40.934 DEBUG --- [           main] o.h.SQL                                  : 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2024-08-26 12:00:41.763 DEBUG --- [ionShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@6be25526, started on Mon Aug 26 12:00:33 CEST 2024
2024-08-26 12:00:41.772  INFO --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2024-08-26 12:00:41.776  INFO --- [ionShutdownHook] c.z.h.HikariDataSource                   : HikariPool-1 - Shutdown initiated...
2024-08-26 12:00:41.783  INFO --- [ionShutdownHook] c.z.h.HikariDataSource                   : HikariPool-1 - Shutdown completed.
